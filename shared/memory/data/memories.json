[
  {
    "id": "ac981966-917c-47c0-880c-fad905f14616",
    "type": "bug_resolution",
    "title": "Fix CSS Variables and Textual Compatibility in legal-extractor-tui",
    "content": "## Problema\nErros de parsing CSS no legal-extractor-tui causados por variáveis CSS inválidas e incompatibilidades com Textual.\n\n## Variáveis Inválidas Encontradas\n- `$text` → `$foreground`\n- `$text-muted` → `$foreground` com `text-style: dim`\n- `$border` → `$primary`\n- `$boost` → `$surface`\n- `$primary-background` → `$surface`\n\n## Outras Correções\n1. Double text-style declarations → combinar em uma\n2. Opacity em color values → remover (não suportado)\n3. Child combinators (>) → usar descendant selectors\n4. `width: 1fr` → `width: 100%` (fr só em grid)\n5. `validate_config()` → `check_config_validity()` (conflito com Textual reactive validators)\n\n## Arquivos Corrigidos (15 total)\n- 4 arquivos .tcss: base, widgets, layout, animations\n- 11 widgets Python com DEFAULT_CSS\n\n## Commit\n`25a627f` fix(legal-extractor-tui): fix invalid CSS variables and Textual compatibility\n\n## Lições\n- Textual tem subset de variáveis CSS válidas: $primary, $secondary, $accent, $foreground, $background, $surface, $panel, $success, $warning, $error\n- Textual reactive validators: métodos `validate_<varname>` são auto-chamados\n- Usar frontend-developer subagent para auditorias CSS",
    "tags": [
      "css",
      "textual",
      "legal-extractor-tui",
      "bug-fix",
      "tcss",
      "theming"
    ],
    "context": {
      "commit": "25a627f",
      "files_changed": 15,
      "project": "legal-extractor-tui",
      "date": "2025-11-27"
    },
    "created_at": "2025-11-27T10:07:08.740651"
  },
  {
    "id": "b7f3c891-4d2e-4a8f-9c1b-d8e6f2a3b5c7",
    "type": "architectural_decision",
    "title": "Claude Code Custom Agents - Descoberta e Registro",
    "content": "## Descoberta Crítica: Como Agentes Customizados Funcionam no Claude Code\n\n### Problema Encontrado\nCriamos agente `tui-master.md` em `.claude/agents/` mas ao usar `Task(subagent_type='tui-master')` recebeu erro \"Agent type 'tui-master' not found\".\n\n### Investigação\n1. Comparamos lista de arquivos `.md` em `.claude/agents/` com lista de `subagent_type` disponíveis\n2. Descobrimos que TODOS os agentes que existiam ANTES da sessão estão disponíveis\n3. Agentes criados DURANTE a sessão NÃO aparecem na lista\n\n### Root Cause\nO Claude Code descobre agentes automaticamente dos arquivos `.md` em:\n- `.claude/agents/` (project-level)\n- `~/.claude/agents/` (user-level global)\n\n**PORÉM**: A descoberta acontece NO INÍCIO DA SESSÃO. Agentes criados durante a sessão só ficam disponíveis após reiniciar o Claude Code.\n\n### Solução\n**Reiniciar a sessão do Claude Code** após criar novos agentes para que sejam detectados.\n\n### Arquivos Relevantes\n- `.claude/hooks/lib/agent-auto-discovery.js` - Script de auto-discovery\n- `.claude/hooks/agent-tools-mapping.json` - Mapeamento gerado (usado pelo Legal-Braniac)\n\n### Lições\n1. Agentes em `.claude/agents/*.md` SÃO detectados automaticamente\n2. A detecção acontece no INÍCIO da sessão, não em tempo real\n3. O mapeamento local (`agent-tools-mapping.json`) é para orquestração interna (Legal-Braniac)\n4. A lista de `subagent_type` da ferramenta Task vem da descoberta automática do Claude Code\n5. Para usar um novo agente: criar arquivo → reiniciar sessão",
    "tags": [
      "claude-code",
      "agents",
      "subagent",
      "task-tool",
      "auto-discovery",
      "architectural-decision"
    ],
    "context": {
      "agent_created": "tui-master",
      "location": ".claude/agents/tui-master.md",
      "global_location": "~/.claude/agents/",
      "date": "2025-11-27"
    },
    "created_at": "2025-11-27T19:50:00.000000"
  },
  {
    "id": "c8e4d902-5f3a-4b9e-0d2c-e9f7g3b4c6d8",
    "type": "solution_pattern",
    "title": "TUI-Master Agent - Especialista Textual TUI",
    "content": "## Agente Criado: tui-master\n\n### Propósito\nEspecialista em desenvolvimento de TUIs com framework Textual (Python). Conhecimento profundo de:\n- TCSS (Textual CSS) vs Web CSS\n- Sistema de temas (11 cores base)\n- DEFAULT_CSS precedence\n- Widgets e layouts\n- textual-dev tools\n\n### Localização\n- Project: `.claude/agents/tui-master.md`\n- Global: `~/.claude/agents/tui-master.md` (copiado)\n\n### Conteúdo Principal\n- 666 linhas de documentação\n- Seções: TCSS vs Web CSS, Theme System, CSS Precedence, Layout Patterns, Widget Styling, Advanced Patterns (TabbedContent, Modal, Toast), Rich Integration\n- Exemplos validados contra docs oficiais\n- Referências a showcase apps (Harlequin, Posting, Dolphie)\n\n### Como Usar\nApós reiniciar sessão:\n```\nTask(subagent_type='tui-master', prompt='...')\n```\n\n### Atualização do Auto-Discovery\nAdicionado `tui-master` ao `exactMatches` em `agent-auto-discovery.js` com tools:\n- Read, Write, Edit, MultiEdit, Bash, Grep, Glob",
    "tags": [
      "tui-master",
      "textual",
      "agent",
      "tcss",
      "tui-development"
    ],
    "context": {
      "file": ".claude/agents/tui-master.md",
      "lines": 666,
      "tools": ["Read", "Write", "Edit", "MultiEdit", "Bash", "Grep", "Glob"],
      "date": "2025-11-27"
    },
    "created_at": "2025-11-27T19:50:00.000000"
  }
]
